<link rel="stylesheet" href="/CSS/chat.css">
</head>

<body>
   <div class="wrapper">
      <div class="one">
         <div class="self">
            <div class="self__user-img">
               <img
                  src="https://d5nunyagcicgy.cloudfront.net/external_assets/hero_examples/hair_beach_v391182663/original.jpeg"
                  alt="<%= user.name %> image">
               <!-- <div class="online-state">
                  <div class="state-text">Online</div>
               </div> -->
            </div>
            <div class="self__user-name">
               <%= user.name %>
            </div>
            <div class="self__user-email">
               <%= user.email %>
            </div>
         </div>
      </div>

      <div class="two">
         <a href="/user/sign-out">
            <img id="sign-out"
               src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHhtbG5zOnN2Z2pzPSJodHRwOi8vc3ZnanMuY29tL3N2Z2pzIiB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiIgeD0iMCIgeT0iMCIgdmlld0JveD0iMCAwIDQ0Ny42NzQgNDQ3LjY3NCIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNTEyIDUxMiIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIgY2xhc3M9IiI+PGc+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+Cgk8Zz4KCQk8cGF0aCBkPSJNMTgyLjcyNSwzNzkuMTUxYy0wLjU3Mi0xLjUyMi0wLjc2OS0yLjgxNi0wLjU3NS0zLjg2M2MwLjE5My0xLjA0LTAuNDcyLTEuOTAyLTEuOTk3LTIuNTY2ICAgIGMtMS41MjUtMC42NjQtMi4yODYtMS4xOTEtMi4yODYtMS41NjdjMC0wLjM4LTEuMDkzLTAuNjY3LTMuMjg0LTAuODU1Yy0yLjE5LTAuMTkxLTMuMjgzLTAuMjg4LTMuMjgzLTAuMjg4aC0zLjcxaC0zLjE0SDgyLjIyNCAgICBjLTEyLjU2MiwwLTIzLjMxNy00LjQ2OS0zMi4yNjQtMTMuNDIxYy04Ljk0NS04Ljk0Ni0xMy40MTctMTkuNjk4LTEzLjQxNy0zMi4yNThWMTIzLjMzNWMwLTEyLjU2Miw0LjQ3MS0yMy4zMTMsMTMuNDE3LTMyLjI1OSAgICBjOC45NDctOC45NDcsMTkuNzAyLTEzLjQyMiwzMi4yNjQtMTMuNDIyaDkxLjM2MWMyLjQ3NSwwLDQuNDIxLTAuNjE0LDUuODUyLTEuODU0YzEuNDI1LTEuMjM3LDIuMzc1LTMuMDk0LDIuODUzLTUuNTY4ICAgIGMwLjQ3Ni0yLjQ3NCwwLjc2My00LjcwOCwwLjg1OS02LjcwN2MwLjA5NC0xLjk5NywwLjA0OC00LjUyMS0wLjE0NC03LjU2NmMtMC4xODktMy4wNDQtMC4yODQtNC45NDctMC4yODQtNS43MTIgICAgYzAtMi40NzQtMC45MDUtNC42MTEtMi43MTItNi40MjNjLTEuODA5LTEuODA0LTMuOTQ5LTIuNzA5LTYuNDIzLTIuNzA5SDgyLjIyNGMtMjIuNjQ4LDAtNDIuMDE2LDguMDQyLTU4LjEwMSwyNC4xMjUgICAgQzguMDQyLDgxLjMyMywwLDEwMC42ODgsMCwxMjMuMzM4djIwMC45OTRjMCwyMi42NDgsOC4wNDIsNDIuMDE4LDI0LjEyMyw1OC4wOTVjMTYuMDg1LDE2LjA5MSwzNS40NTMsMjQuMTMzLDU4LjEwMSwyNC4xMzMgICAgaDkxLjM2NWMyLjQ3NSwwLDQuNDIyLTAuNjIyLDUuODUyLTEuODU0YzEuNDI1LTEuMjM5LDIuMzc1LTMuMDk0LDIuODUzLTUuNTcxYzAuNDc2LTIuNDcxLDAuNzYzLTQuNzE2LDAuODU5LTYuNzA3ICAgIGMwLjA5NC0xLjk5OSwwLjA0OC00LjUxOC0wLjE0NC03LjU2M0MxODIuODE4LDM4MS44MTcsMTgyLjcyNSwzNzkuOTE1LDE4Mi43MjUsMzc5LjE1MXoiIGZpbGw9IiM4Yjk5YTQiIGRhdGEtb3JpZ2luYWw9IiMwMDAwMDAiIHN0eWxlPSIiIGNsYXNzPSIiPjwvcGF0aD4KCQk8cGF0aCBkPSJNNDQyLjI0OSwyMTAuOTg5TDI4Ni45MzUsNTUuNjdjLTMuNjE0LTMuNjEyLTcuODk4LTUuNDI0LTEyLjg0Ny01LjQyNGMtNC45NDksMC05LjIzMywxLjgxMi0xMi44NTEsNS40MjQgICAgYy0zLjYxNywzLjYxNy01LjQyNCw3LjkwNC01LjQyNCwxMi44NXY4Mi4yMjZIMTI3LjkwN2MtNC45NTIsMC05LjIzMywxLjgxMi0xMi44NSw1LjQyNGMtMy42MTcsMy42MTctNS40MjQsNy45MDEtNS40MjQsMTIuODUgICAgdjEwOS42MzZjMCw0Ljk0OCwxLjgwNyw5LjIzMiw1LjQyNCwxMi44NDdjMy42MjEsMy42MSw3LjkwMSw1LjQyNywxMi44NSw1LjQyN2gxMjcuOTA3djgyLjIyNWMwLDQuOTQ1LDEuODA3LDkuMjMzLDUuNDI0LDEyLjg0NyAgICBjMy42MTcsMy42MTcsNy45MDEsNS40MjgsMTIuODUxLDUuNDI4YzQuOTQ4LDAsOS4yMzItMS44MTEsMTIuODQ3LTUuNDI4TDQ0Mi4yNDksMjM2LjY5YzMuNjE3LTMuNjIsNS40MjUtNy44OTgsNS40MjUtMTIuODQ4ICAgIEM0NDcuNjc0LDIxOC44OTQsNDQ1Ljg2NiwyMTQuNjA2LDQ0Mi4yNDksMjEwLjk4OXoiIGZpbGw9IiM4Yjk5YTQiIGRhdGEtb3JpZ2luYWw9IiMwMDAwMDAiIHN0eWxlPSIiIGNsYXNzPSIiPjwvcGF0aD4KCTwvZz4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPC9nPgo8ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8L2c+CjxnIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjwvZz4KPGcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPC9nPgo8L2c+PC9zdmc+" />
         </a>
      </div>

      <div class="three">
         <div class="add-user">
            <form action="/user?_method=patch" method="POST">
               <input type="text" name="email" placeholder="Add contact by email">
               <button>ADD</button>
            </form>
         </div>
      </div>

      <div class="four">
         <% user.contacts.forEach(contact=> {%>
            <a href="/user/<%= contact.id %>">
               <div class="user-container">
                  <dir class="user-img">
                     <img src="https://miro.medium.com/max/1200/1*mk1-6aYaf_Bes1E3Imhc0A.jpeg"
                        alt="<%= contact.name %> image">
                     <!-- <div class="online-state"></div> -->
                  </dir>
                  <div class="user-wrapper">
                     <h4 class="user-name">
                        <%= contact.name %>
                     </h4>
                     <div class="unread-messages"><span>3</span></div>
                     <h5 class="last-message">Hi Danna how are you Do...</h5>
                  </div>
               </div>
            </a>
            <% }) %>
      </div>

      <div class="five">
         <span class="user-name">
            <%=ConversationContact.name %>
         </span>
         <span class="user-email">
            <%= ConversationContact.email %>
         </span>
      </div>

      <div class="six" id="messages">
         <% if (findconversation){ findconversation.messages.forEach(message=> {%>
            <% if(message.author.email===currentUser.email){ %>
               <div class="message-received">
                  <div class="body"><span>
                        <%= message.body %>
                     </span></div>
                  <div class="author">
                     <spane class="name">
                        <%= contact.name %>
                     </spane>
                     <span class="time">
                        <%= new Date(message.timestamp).toString().slice(16,21).trim() %>
                     </span>
                  </div>
               </div>
               <% }else{ %>
                  <div class="message-sent">
                     <div class="body"><span>
                           <%= message.body %>
                        </span></div>
                     <div class="author">
                        <span class="time">
                           <%= new Date(message.timestamp).toString().slice(16,21).trim() %>
                        </span>
                        <spane class="name">You</spane>
                     </div>
                  </div>
                  <% } %>
                     <% });}else if (findconversation2){ findconversation2.messages.forEach(message=> {%>
                        <% if(message.author.email===currentUser.email){ %>
                           <div class="message-received">
                              <div class="body"><span>
                                    <%= message.body %>
                                 </span></div>
                              <div class="author">
                                 <spane class="name">
                                    <%= contact.name %>
                                 </spane>
                                 <span class="time">
                                    <%= new Date(message.timestamp).toString().slice(16,21).trim() %>
                                 </span>
                              </div>
                           </div>
                           <% }else{ %>
                              <div class="message-sent">
                                 <div class="body"><span>
                                       <%= message.body %>
                                    </span></div>
                                 <div class="author">
                                    <span class="time">
                                       <%= new Date(message.timestamp).toString().slice(16,21).trim() %>
                                    </span>
                                    <spane class="name">You</spane>
                                 </div>
                              </div>
                              <% } %>
                                 <% });} %>
      </div>
      <div class="seven">
         <form action="/user/<%= ConversationContact._id %>" method="POST">
            <input type="text" placeholder="Type something to send..." name="message">
            <button>SEND</button>
         </form>
      </div>
   </div>

   <script src="/js/chat.js"></script>